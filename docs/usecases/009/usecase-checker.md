# Usecase êµ¬í˜„ ìƒíƒœ ì ê²€ ë³´ê³ ì„œ

- **ì ê²€ ì¼ì‹œ**: 2025-10-17
- **ì ê²€ ëŒ€ìƒ ë¬¸ì„œ**:
  - spec: `docs\usecases\009\spec.md`
  - ê´€ë ¨ êµ¬í˜„: `src/features/chat-room/backend/`, `src/app/chat/[roomId]/page.tsx`

---

## âœ… êµ¬í˜„ ì™„ë£Œëœ ê¸°ëŠ¥

### 1. ì±„íŒ…ë°© ì§„ì… ë° ì´ˆê¸° ë©”ì‹œì§€ ë¡œë“œ

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ì´ˆê¸° ë©”ì‹œì§€ 30ê°œ ë¡œë“œ | `src/features/chat-room/backend/service.ts:206-279` | âœ… ë¶€ë¶„ ì¶©ì¡± | - ê¶Œí•œ ê²€ì¦ ì™„ë£Œ<br>- ì—ëŸ¬ í•¸ë“¤ë§ ì™„ë£Œ<br>- í…ŒìŠ¤íŠ¸ ì½”ë“œ ì—†ìŒ |
| ê¶Œí•œ ê²€ì¦ (chat_members) | `src/features/chat-room/backend/service.ts:37-54` | âœ… ì™„ì „ ì¶©ì¡± | ëª¨ë“  APIì—ì„œ ì¼ê´€ë˜ê²Œ ì ìš© |
| ë©”ì‹œì§€ ë¦¬ì•¡ì…˜/ì²¨ë¶€íŒŒì¼ ì¡°íšŒ | `src/features/chat-room/backend/service.ts:59-117` | âœ… ì™„ì „ ì¶©ì¡± | ë³„ë„ í—¬í¼ í•¨ìˆ˜ë¡œ ë¶„ë¦¬ |
| ë‹µì¥ ì •ë³´ ì¡°íšŒ | `src/features/chat-room/backend/service.ts:122-155` | âœ… ì™„ì „ ì¶©ì¡± | isDeleted í•„ë“œ í¬í•¨ |
| í˜ì´ì§€ë„¤ì´ì…˜ (hasMore) | `src/features/chat-room/backend/service.ts:262` | âœ… ì™„ì „ ì¶©ì¡± | limit+1 íŒ¨í„´ ì‚¬ìš© |

### 2. Polling ê¸°ë°˜ ì‹¤ì‹œê°„ ë™ê¸°í™”

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| 3ì´ˆ ì£¼ê¸° polling | `src/features/chat-room/constants/index.ts:2`<br>`src/features/chat-room/hooks/useMessagesSync.ts:44` | âœ… ì™„ì „ ì¶©ì¡± | React Query refetchInterval ì‚¬ìš© |
| ì‹ ê·œ ë©”ì‹œì§€ ì¡°íšŒ | `src/features/chat-room/backend/service.ts:303-313` | âœ… ì™„ì „ ì¶©ì¡± | after_timestamp ê¸°ì¤€ ì¡°íšŒ |
| ë³€ê²½ëœ ë©”ì‹œì§€ ì¡°íšŒ | `src/features/chat-room/backend/service.ts:331-342` | âœ… ì™„ì „ ì¶©ì¡± | updated_at ê¸°ì¤€ ì¡°íšŒ |
| ì‚­ì œëœ ë©”ì‹œì§€ í•„í„°ë§ | `src/features/chat-room/backend/service.ts:360-362` | âœ… ì™„ì „ ì¶©ì¡± | is_deleted í•„í„°ë§ |
| ì‘ë‹µ ë°ì´í„° êµ¬ì¡° | `src/features/chat-room/backend/schema.ts:69-75` | âœ… ì™„ì „ ì¶©ì¡± | newMessages, updatedMessages, deletedMessageIds ë¶„ë¦¬ |

### 3. ë¬´í•œ ìŠ¤í¬ë¡¤ (ê³¼ê±° ë©”ì‹œì§€ ë¡œë“œ)

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„ | `src/features/chat-room/hooks/useMessagesQuery.ts:13-33` | âœ… ì™„ì „ ì¶©ì¡± | React Query useInfiniteQuery ì‚¬ìš© |
| ìŠ¤í¬ë¡¤ ìƒë‹¨ ê°ì§€ | `src/features/chat-room/components/message-timeline.tsx:46-53` | âœ… ì™„ì „ ì¶©ì¡± | scrollTop < 100 ì²´í¬ |
| hasMore í”Œë˜ê·¸ | `src/features/chat-room/backend/service.ts:262-263` | âœ… ì™„ì „ ì¶©ì¡± | limit+1 íŒ¨í„´ |
| ë¡œë”© ì¸ë””ì¼€ì´í„° | `src/features/chat-room/components/message-timeline.tsx:85-89` | âœ… ì™„ì „ ì¶©ì¡± | isFetchingNextPage ìƒíƒœ í‘œì‹œ |

### 4. ì½ìŒ ìƒíƒœ ê°±ì‹ 

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| 1ì´ˆ ë””ë°”ìš´ìŠ¤ | `src/features/chat-room/constants/index.ts:4`<br>`src/features/chat-room/hooks/useUpdateReadStatus.ts:27-32` | âœ… ì™„ì „ ì¶©ì¡± | useDebouncedCallback ì‚¬ìš© |
| last_read_message_id ì—…ë°ì´íŠ¸ | `src/features/chat-room/backend/service.ts:754-761` | âœ… ì™„ì „ ì¶©ì¡± | chat_members í…Œì´ë¸” ì—…ë°ì´íŠ¸ |
| last_read_at ì—…ë°ì´íŠ¸ | `src/features/chat-room/backend/service.ts:751` | âœ… ì™„ì „ ì¶©ì¡± | NOW() í•¨ìˆ˜ ì‚¬ìš© |

### 5. ë©”ì‹œì§€ ì „ì†¡

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ë©”ì‹œì§€ ì „ì†¡ API | `src/features/chat-room/backend/service.ts:374-486` | âœ… ì™„ì „ ì¶©ì¡± | ì¤‘ë³µ ë°©ì§€ ë¡œì§ í¬í•¨ |
| ë‹µì¥ ë©”ì‹œì§€ ì „ì†¡ | `src/features/chat-room/backend/service.ts:412-426` | âœ… ì™„ì „ ì¶©ì¡± | reply_to_message_id ê²€ì¦ |
| ì²¨ë¶€íŒŒì¼ ì €ì¥ | `src/features/chat-room/backend/service.ts:456-476` | âœ… ì™„ì „ ì¶©ì¡± | message_attachments í…Œì´ë¸” ì‚½ì… |
| ì¤‘ë³µ ì „ì†¡ ë°©ì§€ (ë©±ë“±ì„±) | `src/features/chat-room/backend/service.ts:394-408` | âœ… ì™„ì „ ì¶©ì¡± | 60ì´ˆ ì´ë‚´ ë™ì¼ ë©”ì‹œì§€ ì²´í¬ |

### 6. ë¦¬ì•¡ì…˜ í† ê¸€

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ë¦¬ì•¡ì…˜ ì¶”ê°€/ì‚­ì œ | `src/features/chat-room/backend/service.ts:491-614` | âœ… ì™„ì „ ì¶©ì¡± | í† ê¸€ ë°©ì‹ êµ¬í˜„ |
| ì‚­ì œëœ ë©”ì‹œì§€ ì²´í¬ | `src/features/chat-room/backend/service.ts:513-519` | âœ… ì™„ì „ ì¶©ì¡± | is_deleted ê²€ì¦ |

### 7. ë©”ì‹œì§€ ì‚­ì œ

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ì†Œí”„íŠ¸ ì‚­ì œ | `src/features/chat-room/backend/service.ts:676-691` | âœ… ì™„ì „ ì¶©ì¡± | is_deleted, deleted_at, content='' |
| ì†Œìœ ê¶Œ ê²€ì¦ | `src/features/chat-room/backend/service.ts:641-647` | âœ… ì™„ì „ ì¶©ì¡± | sender_id ì²´í¬ |
| ë©±ë“±ì„± ë³´ì¥ | `src/features/chat-room/backend/service.ts:650-673` | âœ… ì™„ì „ ì¶©ì¡± | ì´ë¯¸ ì‚­ì œëœ ê²½ìš° ì²˜ë¦¬ |

### 8. ë°ì´í„° êµ¬ì¡° ë° ìŠ¤í‚¤ë§ˆ

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| Message ìŠ¤í‚¤ë§ˆ | `src/features/chat-room/backend/schema.ts:33-48` | âœ… ì™„ì „ ì¶©ì¡± | Specê³¼ 100% ì¼ì¹˜ |
| Reaction ìŠ¤í‚¤ë§ˆ | `src/features/chat-room/backend/schema.ts:20-24` | âœ… ì™„ì „ ì¶©ì¡± | reactionType, count, reactedByMe |
| Attachment ìŠ¤í‚¤ë§ˆ | `src/features/chat-room/backend/schema.ts:26-31` | âœ… ì™„ì „ ì¶©ì¡± | fileUrl, fileType, fileSizeBytes |
| ReplyTo ìŠ¤í‚¤ë§ˆ | `src/features/chat-room/backend/schema.ts:13-18` | âœ… ì™„ì „ ì¶©ì¡± | isDeleted í•„ë“œ í¬í•¨ |
| Zod ëŸ°íƒ€ì„ ê²€ì¦ | `src/features/chat-room/backend/route.ts` | âœ… ì™„ì „ ì¶©ì¡± | ëª¨ë“  ìš”ì²­/ì‘ë‹µ ê²€ì¦ |

### 9. ì—ëŸ¬ ì²˜ë¦¬

| ê¸°ëŠ¥/í˜ì´ì§€ | ê´€ë ¨ ì½”ë“œ íŒŒì¼ | í”„ë¡œë•ì…˜ ë ˆë²¨ ì¶©ì¡± ì—¬ë¶€ | ë¹„ê³  |
|---|---|---|---|
| ê¶Œí•œ ì—†ìŒ (403) | `src/features/chat-room/backend/service.ts:218-222` | âœ… ì™„ì „ ì¶©ì¡± | ëª¨ë“  APIì— ì ìš© |
| ë¦¬ì†ŒìŠ¤ ì—†ìŒ (404) | `src/features/chat-room/backend/service.ts:506-510` | âœ… ì™„ì „ ì¶©ì¡± | ë©”ì‹œì§€/ì±„íŒ…ë°© ì—†ìŒ ì²˜ë¦¬ |
| ì¤‘ë³µ ìš”ì²­ (409) | `src/features/chat-room/backend/service.ts:404-408` | âœ… ì™„ì „ ì¶©ì¡± | ì¤‘ë³µ ë©”ì‹œì§€ ë°©ì§€ |
| ì„œë²„ ì˜¤ë¥˜ (500) | `src/features/chat-room/backend/service.ts:244-250` | âœ… ì™„ì „ ì¶©ì¡± | Supabase ì—ëŸ¬ ì²˜ë¦¬ |
| ì—ëŸ¬ ë¡œê¹… | `src/features/chat-room/backend/route.ts:69-70, 124-126` | âœ… ì™„ì „ ì¶©ì¡± | AppLogger ì‚¬ìš© |
| ì—ëŸ¬ ì½”ë“œ ì •ì˜ | `src/features/chat-room/backend/error.ts` | âœ… ì™„ì „ ì¶©ì¡± | 23ê°œ ì—ëŸ¬ ì½”ë“œ ì •ì˜ |

---

## âŒ êµ¬í˜„ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ë³´ì™„ì´ í•„ìš”í•œ ê¸°ëŠ¥

| ê¸°ëŠ¥/í˜ì´ì§€ | ìƒíƒœ | êµ¬í˜„ ê³„íš |
|---|---|---|
| **Intersection Observer ê¸°ë°˜ ì½ìŒ ì²˜ë¦¬** | âš ï¸ ë¶€ë¶„ êµ¬í˜„ | **í˜„ì¬ ìƒíƒœ**: ìŠ¤í¬ë¡¤ ì‹œ ë§ˆì§€ë§‰ ë©”ì‹œì§€ë§Œ ì½ìŒ ì²˜ë¦¬<br>**Spec ìš”êµ¬ì‚¬í•­**: viewportì— 1ì´ˆ ì´ìƒ ë…¸ì¶œëœ ë©”ì‹œì§€ë§Œ ì½ìŒ ì²˜ë¦¬<br>**í•„ìš” ì‘ì—…**: <br>- `src/features/chat-room/hooks/useMessageVisibility.ts` ìƒì„±<br>- Intersection Observerë¡œ ê° ë©”ì‹œì§€ ë…¸ì¶œ ê°ì§€<br>- 1ì´ˆ íƒ€ì´ë¨¸ë¡œ ë…¸ì¶œ ì‹œê°„ ì²´í¬<br>- ì½ìŒ ì²˜ë¦¬ ëŒ€ìƒ ë©”ì‹œì§€ ID ìˆ˜ì§‘ |
| **ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ìœ ì§€ (ë¬´í•œ ìŠ¤í¬ë¡¤)** | âš ï¸ êµ¬í˜„ ë¶ˆëª…í™• | **Spec ìš”êµ¬ì‚¬í•­**: ê³¼ê±° ë©”ì‹œì§€ ë¡œë“œ ì‹œ í˜„ì¬ ë³´ê³  ìˆë˜ ë©”ì‹œì§€ ìœ„ì¹˜ ìœ ì§€<br>**í•„ìš” ì‘ì—…**:<br>- ê³¼ê±° ë©”ì‹œì§€ ë¡œë“œ ì „ í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥<br>- ë©”ì‹œì§€ ì¶”ê°€ í›„ ìŠ¤í¬ë¡¤ offset ê³„ì‚° ë° ë³µì›<br>- `src/features/chat-room/lib/scroll-utils.ts`ì— `preserveScrollPosition` í•¨ìˆ˜ ì¶”ê°€ |
| **ì‹ ê·œ ë©”ì‹œì§€ ë„ì°© ì‹œ "ìƒˆ ë©”ì‹œì§€ Nê°œ" ë°°ì§€** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: ì‚¬ìš©ìê°€ ìŠ¤í¬ë¡¤ ì¤‘ê°„ì— ìˆì„ ë•Œ ì‹ ê·œ ë©”ì‹œì§€ ë°°ì§€ í‘œì‹œ<br>**í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/contexts/types.ts`ì— `unreadCount` ìƒíƒœ ì¶”ê°€<br>- `src/features/chat-room/components/new-message-badge.tsx` ìƒì„±<br>- ìŠ¤í¬ë¡¤ í•˜ë‹¨ ì—¬ë¶€ ê°ì§€ í›„ ë°°ì§€ í‘œì‹œ/ìˆ¨ê¹€ |
| **ì½ì§€ ì•Šì€ ë©”ì‹œì§€ êµ¬ë¶„ì„ ** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: last_read_message_id ê¸°ì¤€ "ì—¬ê¸°ê¹Œì§€ ì½ìœ¼ì…¨ìŠµë‹ˆë‹¤" êµ¬ë¶„ì„ <br>**í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/components/unread-divider.tsx` ìƒì„±<br>- MessageTimelineì—ì„œ last_read_message_id ì´í›„ ì²« ë©”ì‹œì§€ ìœ„ì— í‘œì‹œ<br>- ì´ˆê¸° ì§„ì… ì‹œ í•´ë‹¹ ìœ„ì¹˜ë¡œ ìë™ ìŠ¤í¬ë¡¤ |
| **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ Exponential Backoff** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: 3ì´ˆ â†’ 6ì´ˆ â†’ 12ì´ˆ â†’ ìµœëŒ€ 30ì´ˆ<br>**í•„ìš” ì‘ì—…**:<br>- `src/lib/remote/api-client.ts`ì— retry ë¡œì§ ì¶”ê°€<br>- `axios-retry` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ê³ ë ¤<br>- ë˜ëŠ” React Queryì˜ `retry`, `retryDelay` ì˜µì…˜ í™œìš© |
| **ì±„íŒ…ë°© ì´íƒˆ ì‹œ AbortController** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: ë©”ì‹œì§€ ë¡œë“œ ì¤‘ ì‚¬ìš©ì ì´íƒˆ ì‹œ ìš”ì²­ ì·¨ì†Œ<br>**í•„ìš” ì‘ì—…**:<br>- useMessagesQuery, useMessagesSync í›…ì—ì„œ cleanup í•¨ìˆ˜ ì¶”ê°€<br>- AbortController ìƒì„± ë° signal ì „ë‹¬<br>- unmount ì‹œ abort() í˜¸ì¶œ |
| **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë°°ë„ˆ** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: "ì—°ê²° ëŠê¹€" ë°°ë„ˆ + ì¬ì‹œë„ ë²„íŠ¼<br>**í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/components/network-error-banner.tsx` ìƒì„±<br>- React Queryì˜ `isError` ìƒíƒœ ê°ì§€<br>- ìˆ˜ë™ ì¬ì‹œë„ ë²„íŠ¼ ì¶”ê°€ (refetch í˜¸ì¶œ) |
| **ì‹¤ì‹œê°„ ê¶Œí•œ ìƒì‹¤ ëª¨ë‹¬** | âŒ ë¯¸êµ¬í˜„ | **Spec ìš”êµ¬ì‚¬í•­**: Polling ì¤‘ 403 ë°œìƒ ì‹œ "ì±„íŒ…ë°©ì—ì„œ ë‚˜ê°€ì…¨ìŠµë‹ˆë‹¤" ëª¨ë‹¬<br>**í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/components/kicked-modal.tsx` ìƒì„±<br>- useMessagesSyncì—ì„œ 403 ì—ëŸ¬ ê°ì§€<br>- polling ì¤‘ë‹¨ + ëª¨ë‹¬ í‘œì‹œ + ì±„íŒ… ëª©ë¡ìœ¼ë¡œ ì´ë™ |
| **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸** | âŒ ë¯¸êµ¬í˜„ | **í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/backend/__tests__/service.test.ts` ìƒì„±<br>- ê° ì„œë¹„ìŠ¤ í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ (ê¶Œí•œ ê²€ì¦, ë©”ì‹œì§€ ì¡°íšŒ, ì¤‘ë³µ ë°©ì§€ ë“±)<br>- Supabase ëª¨í‚¹ (jest-mock-supabase ì‚¬ìš©)<br>- ìµœì†Œ ì»¤ë²„ë¦¬ì§€ ëª©í‘œ: 80% |
| **í†µí•© í…ŒìŠ¤íŠ¸** | âŒ ë¯¸êµ¬í˜„ | **í•„ìš” ì‘ì—…**:<br>- `src/features/chat-room/__tests__/integration.test.ts` ìƒì„±<br>- ì „ì²´ flow í…ŒìŠ¤íŠ¸ (ì§„ì… â†’ ë©”ì‹œì§€ ë¡œë“œ â†’ Polling â†’ ì „ì†¡)<br>- Playwright ë˜ëŠ” Cypressë¡œ E2E í…ŒìŠ¤íŠ¸ ê³ ë ¤ |
| **before_message_id íŒŒë¼ë¯¸í„° ì§€ì›** | âš ï¸ ë¶ˆì¼ì¹˜ | **í˜„ì¬ ìƒíƒœ**: `beforeTimestamp` íŒŒë¼ë¯¸í„° ì‚¬ìš© ì¤‘<br>**Spec ìš”êµ¬ì‚¬í•­**: `before_message_id` íŒŒë¼ë¯¸í„° ì‚¬ìš©<br>**í•„ìš” ì‘ì—…**:<br>- route.tsì—ì„œ `before_message_id` íŒŒë¼ë¯¸í„° ì¶”ê°€<br>- service.tsì—ì„œ ID ê¸°ì¤€ ì¡°íšŒ ë¡œì§ ìˆ˜ì •<br>- `created_at`ê³¼ `id`ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì •í™•í•œ ìˆœì„œ ë³´ì¥ |

---

## ğŸ“ ì¢…í•© ì˜ê²¬

### ì „ë°˜ì ì¸ êµ¬í˜„ ìƒíƒœ
ìœ ìŠ¤ì¼€ì´ìŠ¤ 009 "ì±„íŒ…ë°© ì§„ì… ë° ë©”ì‹œì§€ ë™ê¸°í™”"ì˜ **í•µì‹¬ ê¸°ëŠ¥ì€ ì•½ 80-85% êµ¬í˜„ ì™„ë£Œ**ë˜ì—ˆìŠµë‹ˆë‹¤. ë°±ì—”ë“œ APIì™€ ë°ì´í„°ë² ì´ìŠ¤ ë¡œì§ì€ í”„ë¡œë•ì…˜ ë ˆë²¨ì— ê·¼ì ‘í•˜ë©°, í”„ë¡ íŠ¸ì—”ë“œ ê¸°ë³¸ ê¸°ëŠ¥ë„ ì˜ ì‘ë™í•©ë‹ˆë‹¤.

### ì£¼ìš” ê°•ì 
1. **ê²¬ê³ í•œ ë°±ì—”ë“œ ì•„í‚¤í…ì²˜**:
   - Zod ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ íƒ€ì… ì•ˆì „ì„±
   - ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ (`HandlerResult`)
   - ëª¨ë“  APIì— ê¶Œí•œ ê²€ì¦ ì ìš©
   - ë©±ë“±ì„± ë³´ì¥ (ì¤‘ë³µ ë©”ì‹œì§€ ë°©ì§€, ì‚­ì œ ì¬ì‹œë„)

2. **ë°ì´í„° ì •í•©ì„±**:
   - Spec ë¬¸ì„œì˜ ë°ì´í„° êµ¬ì¡°ì™€ 100% ì¼ì¹˜
   - ë¦¬ì•¡ì…˜, ì²¨ë¶€íŒŒì¼, ë‹µì¥ ì •ë³´ ì™„ì „ êµ¬í˜„
   - soft delete íŒ¨í„´ ì ìš©

3. **í”„ë¡ íŠ¸ì—”ë“œ ìƒíƒœ ê´€ë¦¬**:
   - React Queryë¡œ ì„œë²„ ìƒíƒœ ê´€ë¦¬
   - Context APIë¡œ ë¡œì»¬ ìƒíƒœ ê´€ë¦¬
   - ë¬´í•œ ìŠ¤í¬ë¡¤, ì‹¤ì‹œê°„ ë™ê¸°í™” êµ¬í˜„

### ë³´ì™„ì´ í•„ìš”í•œ ë¶€ë¶„

#### 1. **UX ê°œì„  ì‚¬í•­ (ì¤‘ìš”ë„: ë†’ìŒ)**
- âŒ ì½ì§€ ì•Šì€ ë©”ì‹œì§€ êµ¬ë¶„ì„  ë¯¸êµ¬í˜„ â†’ ì‚¬ìš©ìê°€ ì–´ë””ê¹Œì§€ ì½ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìŒ
- âŒ ì‹ ê·œ ë©”ì‹œì§€ ë°°ì§€ ë¯¸êµ¬í˜„ â†’ ìŠ¤í¬ë¡¤ ì¤‘ê°„ì—ì„œ ìƒˆ ë©”ì‹œì§€ ì•Œë¦¼ ì—†ìŒ
- âš ï¸ Intersection Observer ë¯¸ì‚¬ìš© â†’ ì‹¤ì œë¡œ ë³¸ ë©”ì‹œì§€ë§Œ ì½ìŒ ì²˜ë¦¬í•´ì•¼ í•¨

#### 2. **ì—ëŸ¬ ë³µêµ¬ ë¡œì§ (ì¤‘ìš”ë„: ì¤‘ê°„)**
- âŒ Exponential backoff ë¯¸êµ¬í˜„ â†’ ë„¤íŠ¸ì›Œí¬ ì¥ì•  ì‹œ ì„œë²„ ë¶€í•˜ ê°€ì¤‘
- âŒ AbortController ë¯¸êµ¬í˜„ â†’ ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë‚­ë¹„
- âŒ ì—ëŸ¬ UI ë¯¸êµ¬í˜„ â†’ ì‚¬ìš©ìê°€ ì˜¤ë¥˜ ìƒí™©ì„ ì¸ì§€í•˜ê¸° ì–´ë ¤ì›€

#### 3. **í…ŒìŠ¤íŠ¸ ì½”ë“œ (ì¤‘ìš”ë„: ë†’ìŒ)**
- âŒ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 0% â†’ ë¦¬íŒ©í† ë§ ì‹œ íšŒê·€ ë²„ê·¸ ìœ„í—˜
- âŒ í†µí•© í…ŒìŠ¤íŠ¸ 0% â†’ ì „ì²´ flow ê²€ì¦ ë¶ˆê°€ëŠ¥
- **í”„ë¡œë•ì…˜ ë°°í¬ ì „ í•„ìˆ˜ ì‘ì—…**

#### 4. **Spec ë¶ˆì¼ì¹˜ (ì¤‘ìš”ë„: ë‚®ìŒ)**
- âš ï¸ `before_message_id` ëŒ€ì‹  `beforeTimestamp` ì‚¬ìš© â†’ ë™ì¼ ì‹œê°„ëŒ€ ë©”ì‹œì§€ ìˆœì„œ ë³´ì¥ ë¬¸ì œ ê°€ëŠ¥ì„±
- âš ï¸ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ìœ ì§€ ë¡œì§ ë¶ˆëª…í™• â†’ ë¬´í•œ ìŠ¤í¬ë¡¤ ì‹œ UI ì í”„ ë°œìƒ ê°€ëŠ¥

### í”„ë¡œë•ì…˜ ë°°í¬ ì „ í•„ìˆ˜ ì‘ì—… (ìš°ì„ ìˆœìœ„)

#### P0 (Critical - ë°°í¬ ì „ ë°˜ë“œì‹œ í•„ìš”)
1. **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±**: í•µì‹¬ ì„œë¹„ìŠ¤ í•¨ìˆ˜ (ê¶Œí•œ ê²€ì¦, ë©”ì‹œì§€ ì¡°íšŒ, ì¤‘ë³µ ë°©ì§€)
2. **ì½ì§€ ì•Šì€ ë©”ì‹œì§€ UI**: êµ¬ë¶„ì„  + ì´ˆê¸° ìŠ¤í¬ë¡¤ ìœ„ì¹˜
3. **ì—ëŸ¬ ì²˜ë¦¬ UI**: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë°°ë„ˆ, ê¶Œí•œ ìƒì‹¤ ëª¨ë‹¬

#### P1 (Important - ì´ˆê¸° ë¦´ë¦¬ì¦ˆ ì´í›„ ë¹ ë¥´ê²Œ)
1. **Intersection Observer ì½ìŒ ì²˜ë¦¬**: ì‹¤ì œ ë³¸ ë©”ì‹œì§€ë§Œ ì½ìŒ ì²˜ë¦¬
2. **Exponential Backoff**: ë„¤íŠ¸ì›Œí¬ ì¥ì•  ë³µêµ¬ ë¡œì§
3. **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ ì±„íŒ… flow ê²€ì¦

#### P2 (Nice to have - ì ì§„ì  ê°œì„ )
1. **ì‹ ê·œ ë©”ì‹œì§€ ë°°ì§€**: ìŠ¤í¬ë¡¤ ì¤‘ê°„ì—ì„œ ì•Œë¦¼
2. **AbortController**: ìš”ì²­ ì·¨ì†Œ ìµœì í™”
3. **ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ìœ ì§€**: ë¬´í•œ ìŠ¤í¬ë¡¤ UX ê°œì„ 

### ê¸ì •ì ì¸ í‰ê°€
- ì½”ë“œ í’ˆì§ˆì´ ì „ë°˜ì ìœ¼ë¡œ ë†’ê³ , ì•„í‚¤í…ì²˜ê°€ í™•ì¥ ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„ë¨
- ì—ëŸ¬ í•¸ë“¤ë§ê³¼ ìœ íš¨ì„± ê²€ì‚¬ê°€ ì˜ êµ¬í˜„ë˜ì–´ ìˆì–´ ì•ˆì •ì„± í™•ë³´
- Spec ë¬¸ì„œì™€ êµ¬í˜„ì´ ëŒ€ë¶€ë¶„ ì¼ì¹˜í•˜ì—¬ ìš”êµ¬ì‚¬í•­ ì¶©ì‹¤ë„ ë†’ìŒ
- í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ ì¼ë¶€ UX ê°œì„ ë§Œ ì¶”ê°€í•˜ë©´ í”„ë¡œë•ì…˜ ë°°í¬ ê°€ëŠ¥

### ìµœì¢… ê²°ë¡ 
í˜„ì¬ êµ¬í˜„ì€ **MVP(Minimum Viable Product) ìˆ˜ì¤€ì„ ì¶©ì¡±**í•˜ë©°, í•µì‹¬ ê¸°ëŠ¥ì€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤. ë‹¤ë§Œ **í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì•ˆì •ì ìœ¼ë¡œ ìš´ì˜í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ P0/P1 í•­ëª©ë“¤ì„ ë°˜ë“œì‹œ ë³´ì™„**í•´ì•¼ í•©ë‹ˆë‹¤. íŠ¹íˆ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì€ ì½”ë“œ í’ˆì§ˆê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ìœ„í•´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.
